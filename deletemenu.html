<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delete Menu Items</title>
</head>
<body>
    <header>
        <div class="container header-container">
            <a href="#" class="logo">The Kings<span>Menu</span></a>
            <nav>
                <ul>
                    <li><a href="dashboard.html">Back to Dashboard</a></li>
                </ul>
            </nav>
        </div>
    </header>
    <section class="menu-section" id="menu">
        <div class="container">
            <div class="section-title">
                <h2>Delete Menu Items</h2>
            </div>
            <div class="menu-items" id="menu-items">
                <div class="loading">Loading menu items...</div>
            </div>
        </div>
    </section>
    <footer>
        <p>&copy; 2020-2025 The Kings Menu Pvt Ltd</p>
    </footer>
    <script>
        function loadMenuItems() {
            fetch('menu.php')
                .then(res => res.text())
                .then(html => {
                    document.getElementById('menu-items').innerHTML = html;
                    addDeleteButtons();
                })
            .catch(err => {
                    document.getElementById('menu-items').innerHTML = '<p>Failed to load items.</p>';
                    console.error(err);
                });
        }
        function addDeleteButtons() {
            const items = document.querySelectorAll('.menu-item');
            items.forEach(item => {
                if (item.querySelector('.delete-btn')) return;
                const deleteBtn = document.createElement('button');
                deleteBtn.textContent = "âˆ’";
                deleteBtn.className = 'delete-btn';
                const id = item.getAttribute('data-id');

                const imgContainer = item.querySelector('.menu-item-img');
                if (imgContainer) {
                    imgContainer.style.position = 'relative';
                    imgContainer.appendChild(deleteBtn);
                } else {
                    item.appendChild(deleteBtn);
                }
                deleteBtn.addEventListener('click', () => {
                    Swal.fire({
                        title: 'Are you sure?',
                        text: "Do you want to delete this menu item?",
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#e74c3c',
                        cancelButtonColor: '#3085d6',
                        confirmButtonText: 'Yes, delete it!',
                        cancelButtonText: 'Cancel',
                        reverseButtons: true
                    }).then((result) => {
                        if (result.isConfirmed) {
                            fetch('deletemenu.php', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                                body: 'id=' + encodeURIComponent(id)
                            }).then(res => res.text())
                            .then(response => {
                                Swal.fire(
                                    'Deleted!',
                                    response,
                                    'success'
                                );
                                item.remove();
                            }).catch(err => {
                                Swal.fire(
                                    'Error!',
                                    'Delete failed. Please try again.',
                                    'error'
                                );
                                console.error(err);
                            });
                        }
                    });
                });
            });
        }


    </script>
</body>
</html>
